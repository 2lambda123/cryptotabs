#!/bin/sh -e

SYSCONFDIR='<%= node['apache']['dir'] %>'

if [ -z $1 ]; then
        echo "Which conf would you like to disable?"
        echo -n "Your choices are: "
        ls $SYSCONFDIR/conf-enabled/*.conf | \
        sed -e "s,$SYSCONFDIR/conf-enabled/,,g" | sed -e 's/\.load$//g;' | xargs echo
        echo -n "Conf name? "
        read CONFNAME
else
        CONFNAME=$1
fi

if ! [ -e $SYSCONFDIR/conf-enabled/$CONFNAME.conf ]; then
        echo "This Conf is already disabled, or does not exist!"
        exit 1
fi

rm -f $SYSCONFDIR/conf-enabled/$CONFNAME.conf
echo "Conf $CONFNAME disabled; reload apache to fully disable."
